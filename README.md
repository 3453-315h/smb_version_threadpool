smbver.exe 192.168.1.0 255.255.255.0 20
smbver.exe 地址 子网掩码 线程数

加入
1.线程池 提高获取效率
2.判断端口 自动探测139与445端口是否开放 选择开放的端口进行探测

与x年前与zcgonvh老哥交流时二次开发自http://www.zcgonvh.com/post/CSharp_smb_version_Detection.html

在此再次感谢zcgonvh老哥对我的多次帮助

Result.csv

"192.168.1.242","native os: Windows Server 2003 3790 Service Pack 2","native lan manager: Windows Server 2003 5.2","negotiate target: 7KBTEST","os major version: 5","os minor version: 2","os build number: 3790","ntlm current revision: 15","NetBIOS domain name: 7KBTEST","NetBIOS computer name: DC-2003","DNS domain name: 7kbtest.com","DNS computer name: Dc-2003.7kbtest.com","DNS tree name: 7kbtest.com"
"192.168.1.241","native os: Windows Server 2012 R2 Standard 9600","native lan manager: Windows Server 2012 R2 Standard 6.3","negotiate target: 7KBTEST","os major version: 6","os minor version: 3","os build number: 9600","ntlm current revision: 15","NetBIOS domain name: 7KBTEST","NetBIOS computer name: DC-2012","DNS domain name: 7kbtest.com","DNS computer name: Dc-2012.7kbtest.com","DNS tree name: 7kbtest.com","time stamp:2020/1/8 2:42:06"
"192.168.1.240","native os: Windows Server 2008 R2 Datacenter 7601 Service Pack 1","native lan manager: Windows Server 2008 R2 Datacenter 6.1","negotiate target: 7KBTEST","os major version: 6","os minor version: 1","os build number: 7601","ntlm current revision: 15","NetBIOS domain name: 7KBTEST","NetBIOS computer name: DC-2008","DNS domain name: 7kbtest.com","DNS computer name: Dc-2008.7kbtest.com","DNS tree name: 7kbtest.com","time stamp:2020/1/8 2:42:06"
